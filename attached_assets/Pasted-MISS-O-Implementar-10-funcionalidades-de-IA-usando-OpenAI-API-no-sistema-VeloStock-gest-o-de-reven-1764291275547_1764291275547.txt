MISSÃƒO: Implementar 10 funcionalidades de IA usando OpenAI API no sistema VeloStock (gestÃ£o de revendas de veÃ­culos).
---
## ğŸ“‹ CONTEXTO DO PROJETO
Sistema: VeloStock - GestÃ£o completa de concessionÃ¡rias
Stack: React + TypeScript + Express + PostgreSQL + Drizzle ORM
IA existente: AdGenerator (geraÃ§Ã£o de anÃºncios) e PriceSuggestion (sugestÃ£o de preÃ§os)
Chave API: JÃ¡ configurada em process.env.OPENAI_API_KEY
---
## ğŸ¯ FUNCIONALIDADES A IMPLEMENTAR
### 1ï¸âƒ£ **Assistente de Leads Inteligente** (PRIORIDADE ALTA)
ğŸ“ Arquivos: `client/src/components/LeadAssistant.tsx` + `server/routes/leads.ts`
**Frontend (LeadAssistant.tsx):**
- Componente com textarea para conversa do lead
- BotÃ£o "Sugerir Resposta IA"
- ExibiÃ§Ã£o da resposta sugerida
- BotÃ£o para copiar/enviar via WhatsApp
**Backend (POST /api/leads/:id/suggest-response):**
- Buscar histÃ³rico de follow-ups do lead
- Criar prompt: "Baseado neste histÃ³rico: [followUps], sugira uma resposta profissional e persuasiva"
- Usar GPT-4o-mini
- Retornar { suggestedResponse: string }
**IntegraÃ§Ã£o:**
- Adicionar botÃ£o "ğŸ¤– Sugerir Resposta" em `client/src/pages/Leads.tsx`
- Abrir modal `<LeadAssistant leadId={lead.id} />`
---
### 2ï¸âƒ£ **AnÃ¡lise de Desempenho de Vendedores**
ğŸ“ Arquivos: `server/routes/financial.ts` (novo endpoint)
**Backend (POST /api/financial/seller-analysis):**
- Buscar mÃ©tricas do vendedor (vendas, comissÃµes, taxa de conversÃ£o)
- Prompt: "Analise o desempenho: [dados]. ForneÃ§a insights, pontos fortes, Ã¡reas de melhoria e sugestÃµes de treinamento"
- Retornar { analysis: string, recommendations: string[] }
**Frontend:**
- Adicionar botÃ£o "ğŸ“Š AnÃ¡lise IA" em `client/src/components/SellerDashboard.tsx`
- Exibir anÃ¡lise em Dialog
---
### 3ï¸âƒ£ **Melhorar GeraÃ§Ã£o de AnÃºncios (Multi-Plataforma)**
ğŸ“ Arquivo: `server/routes.ts` (modificar endpoint existente)
**Modificar POST /api/vehicles/:id/generate-ad:**
- Retornar objeto em vez de string:
```json
{
  "instagram_story": "50 chars",
  "instagram_feed": "150 chars",
  "facebook": "200 chars",
  "olx_title": "SEO otimizado - 60 chars",
  "whatsapp": "tom conversacional"
}
Frontend (AdGenerator.tsx):

Adicionar tabs para cada plataforma
BotÃ£o de copiar individual por plataforma
Mostrar contagem de caracteres
4ï¸âƒ£ Chatbot FAQ Inteligente
ğŸ“ Arquivos: client/src/components/ChatbotWidget.tsx + server/routes.ts

Frontend (ChatbotWidget.tsx):

Ãcone flutuante no canto inferior direito (ğŸ’¬)
Modal com histÃ³rico de conversa
Input de mensagem
Respostas da IA em tempo real
Backend (POST /api/chatbot/message):

System prompt: "VocÃª Ã© assistente da [empresa]. Responda perguntas sobre compra de carros, financiamento, documentos, garantia..."
Usar GPT-4o-mini
Manter contexto da conversa (Ãºltimas 5 mensagens)
IntegraÃ§Ã£o:

Adicionar <ChatbotWidget /> em client/src/App.tsx
5ï¸âƒ£ SugestÃ£o de ObservaÃ§Ãµes para Checklists
ğŸ“ Arquivo: client/src/components/ChecklistObservationDialog.tsx

Adicionar botÃ£o "âœ¨ Sugerir com IA":

Quando item marcado como "Fazer Reparo"
Endpoint: POST /api/checklists/suggest-observation
Prompt: "Item do checklist: [nome]. Categoria: [categoria]. VeÃ­culo: [marca modelo]. Sugira observaÃ§Ã£o tÃ©cnica profissional"
Auto-preencher campo de observaÃ§Ã£o
6ï¸âƒ£ Email Marketing Personalizado
ğŸ“ Arquivos: client/src/pages/Leads.tsx + server/routes/leads.ts

Backend (POST /api/leads/generate-email-campaign):

Input: leadIds[], campaignType ("followup" | "promotion" | "reactivation")
Para cada lead: gerar email personalizado
Prompt: "Crie email de [tipo] para [nome], interessado em [veÃ­culo]. Tom: [profissional/amigÃ¡vel]"
Retornar array de { leadId, subject, body }
Frontend:

BotÃ£o "ğŸ“§ Campanha Email IA" na lista de leads
SeleÃ§Ã£o de leads (checkboxes)
Preview dos emails antes de enviar
7ï¸âƒ£ AnÃ¡lise de PrecificaÃ§Ã£o DinÃ¢mica
ğŸ“ Arquivo: client/src/components/PriceSuggestion.tsx (melhorar existente)

Adicionar anÃ¡lise de mercado:

Buscar veÃ­culos similares no estoque
Considerar tempo parado (>30 dias = sugerir desconto)
Sazonalidade (fim de ano, fÃ©rias)
Prompt: "VeÃ­culo: [dados]. Similares: [lista]. Dias parado: [X]. Ã‰poca: [mÃªs]. Sugira preÃ§o estratÃ©gico e justifique"
8ï¸âƒ£ Resumo AutomÃ¡tico de Notas
ğŸ“ Arquivos: client/src/pages/Notes.tsx + server/routes.ts

Backend (POST /api/notes/:id/summarize):

Buscar conteÃºdo da nota
Prompt: "Resuma esta nota em 2-3 tÃ³picos principais: [conteÃºdo]"
Retornar { summary: string }
Frontend:

BotÃ£o "ğŸ“ Resumir IA" em cada nota
Exibir resumo acima do conteÃºdo completo
9ï¸âƒ£ Meta de Vendas Inteligente (Coaching)
ğŸ“ Arquivo: client/src/components/SellerDashboard.tsx

Backend (POST /api/financial/seller-coaching):

Buscar progresso atual vs meta
Leads em pipeline
HistÃ³rico de vendas
Prompt: "Vendedor: [nome]. Meta: [X]. Progresso: [Y%]. Leads: [lista]. ForneÃ§a 3 dicas especÃ­ficas para atingir a meta"
Retornar { tips: string[], focusArea: string }
Frontend:

Card "ğŸ¯ Coaching IA" no dashboard do vendedor
Atualizar diariamente
ğŸ”Ÿ GeraÃ§Ã£o de TÃ­tulos SEO para AnÃºncios
ğŸ“ Integrar em AdGenerator.tsx

Adicionar campo "TÃ­tulo SEO":

Prompt: "Gere tÃ­tulo SEO otimizado (60 chars) para: [marca modelo ano]. Palavras-chave: usado, [cidade], financiamento"
Exibir junto com os outros formatos de anÃºncio
ğŸ“¦ ESTRUTURA DE IMPLEMENTAÃ‡ÃƒO
FASE 1 - FundaÃ§Ã£o (Dias 1-2)
Criar server/utils/openai.ts com helpers:

generateCompletion(prompt, options)
generateJSON(prompt, schema)
Tratamento de erros (quota, rate limit)
Melhorar componentes existentes:

AdGenerator (multi-plataforma)
PriceSuggestion (anÃ¡lise dinÃ¢mica)
FASE 2 - Leads e CRM (Dias 3-4)
Implementar LeadAssistant
Email marketing personalizado
AnÃ¡lise de desempenho
FASE 3 - UX e AutomaÃ§Ã£o (Dias 5-6)
Chatbot FAQ
SugestÃµes de checklist
Resumo de notas
FASE 4 - InteligÃªncia de Vendas (Dia 7)
Coaching de vendedores
TÃ­tulos SEO
âš™ï¸ PADRÃ•ES A SEGUIR
Tratamento de Erros:

try {
  const completion = await openai.chat.completions.create({...});
  // ...
} catch (error: any) {
  if (error.status === 429) {
    return res.status(429).json({ 
      error: "Limite de uso excedido. Tente mais tarde." 
    });
  }
  // ...
}
ValidaÃ§Ã£o de API Key:

if (!process.env.OPENAI_API_KEY) {
  return res.status(400).json({ 
    error: "OpenAI API nÃ£o configurada" 
  });
}
UI Consistente:

BotÃµes com Ã­cone âœ¨ para recursos IA
Loading states com "Gerando..." ou spinner
Toast notifications para sucesso/erro
MÃ¡ximo 600 tokens por request (custo-benefÃ­cio)
ğŸ¨ COMPONENTES UI NECESSÃRIOS
Criar em client/src/components/:

LeadAssistant.tsx
ChatbotWidget.tsx
SellerAnalysisDialog.tsx
EmailCampaignDialog.tsx
CoachingCard.tsx
ğŸ” SEGURANÃ‡A
NUNCA expor OPENAI_API_KEY no frontend
Validar empresaId em todos os endpoints
Rate limiting: mÃ¡x 10 requests/min por usuÃ¡rio
Sanitizar inputs do usuÃ¡rio antes de enviar Ã  IA
ğŸ“Š MÃ‰TRICAS DE SUCESSO
ApÃ³s implementaÃ§Ã£o, adicionar tracking:

Quantas sugestÃµes IA foram aceitas/rejeitadas
Tempo mÃ©dio economizado por funcionalidade
ROI (vendas geradas vs custo de API)
ğŸš€ ORDEM DE IMPLEMENTAÃ‡ÃƒO RECOMENDADA
AdGenerator Multi-Plataforma (jÃ¡ existe base)
LeadAssistant (alto impacto em vendas)
PriceSuggestion DinÃ¢mica (melhora margem)
Chatbot FAQ (reduz atendimento manual)
Email Marketing (automaÃ§Ã£o)
Restante conforme demanda
IMPORTANTE:

Use GPT-4o-mini (mais barato) para a maioria
GPT-4 apenas se precisar raciocÃ­nio complexo
Valide TODOS os inputs do usuÃ¡rio
Implemente cache quando possÃ­vel (ex: FAQ)
Adicione botÃ£o "âš™ï¸ Configurar IA" em Settings para ajustar comportamento
Comece pela funcionalidade #1 (LeadAssistant) e vÃ¡ implementando sequencialmente!